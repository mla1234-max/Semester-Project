#include <iostream>
#include <string.h>

using namespace std;

void RemoveInventory(float invChart[7][4], string invName[7], int section);
void CheckInventory(float invChart[7][4], string invName[7]);
void AddInventory(float invChart[7][4], string invName[7], int section);
void AddUpTotal(float invChart[7][4], string invName[7]);

int main() {
    string invName[7] = {{"XXXXXXXXXX"},
                        {"XXXXXXXXXX"},
                        {"XXXXXXXXXX"},
                        {"XXXXXXXXXX"},
                        {"XXXXXXXXXX"},
                        {"XXXXXXXXXX"},
                        {"XXXXXXXXXX"}};
    float invChart[7][4] = {{'X','X','X','X'},
                            {'X','X','X','X'},
                            {'X','X','X','X'},
                            {'X','X','X','X'},
                            {'X','X','X','X'},
                            {'X','X','X','X'},
                            {'X','X','X','X'}};
    int selection = 0;
    int section;
    char enterAgain = 'N';
    do {
        cout << "[1] Check inventory\n[2] Add to inventory\n[3] Remove from inventory\n[4] Add up total values\nSelect an action: ";
        cin >> selection;
        while (selection < 1 || selection > 4) {
            cout << "Enter a value between 1 and 4:";
            cin >> selection;
        }
        switch(selection) {
        
        case 1:
            CheckInventory(invChart, invName);
            break;
        case 2:
            AddInventory(invChart, invName, section);
            break;
        case 3:
            RemoveInventory(invChart, invName, section);
            break;
        case 4:
            AddUpTotal(invChart, invName);
            break;
        }
        cout << "\nWould you like to do something else?" << endl
             << "Enter Y for yes and anything else to quit: ";
        cin  >> enterAgain;
    } while(enterAgain == 'Y' || enterAgain == 'y');
    
    return 0;
}

void RemoveInventory(float invChart[7][4], string invName[7], int section) {
    
    double removeAmount;
    cout << "Enter the section of inventory (1 to 7): ";
    cin >> section;
    
    if((invName[section - 1] != "XXXXXXXXXX") && (invChart[section - 1][1] != 'X') && (invChart[section - 1][2] != 'X') && (invChart[section - 1][3] == 1.0)) {
        
        invName[section - 1] = "XXXXXXXXXX";
        invChart[section - 1][0] = 'X';
        invChart[section - 1][1] = 'X';
        invChart[section - 1][2] = 'X';
        invChart[section - 1][3] = 'X';
        cout << "Your item has been removed.\n";
    }
    else if ((invName[section - 1] != "XXXXXXXXXX") && (invChart[section - 1][1] != 'X') && (invChart[section - 1][2] != 'X') && (invChart[section - 1][3] > 1.0)) {
        cout << "How much of this item do you want to remove (in decimal form)?: ";
        cin >> removeAmount;
        
        while (removeAmount < 1 && removeAmount > invChart[section - 1][3]) {
            cout << "Please select a valid remove amount: ";
            cin >> removeAmount;
        }
        
        if (removeAmount < invChart[section - 1][3]) {
            invChart[section - 1][3] = invChart[section - 1][3] - removeAmount;
            cout << "Your item's specified amount has been removed.\n";
        }
        else {
            invName[section - 1] = "XXXXXXXXXX";
            invChart[section - 1][0] = 'X';
            invChart[section - 1][1] = 'X';
            invChart[section - 1][2] = 'X';
            invChart[section - 1][3] = 'X';
            cout << "Your item has been removed.\n";
        }
    }
    else if ((invName[section - 1] != "XXXXXXXXXX") && (invChart[section - 1][1] != 'X') && (invChart[section - 1][2] != 'X') && (invChart[section - 1][3] != 'X')) {
        invName[section - 1] = "XXXXXXXXXX";
            invChart[section - 1][0] = 'X';
            invChart[section - 1][1] = 'X';
            invChart[section - 1][2] = 'X';
            invChart[section - 1][3] = 'X';
            cout << "Your item has been removed.\n";
    }
    else {
        cout << "Sorry, this section is already empty";
    }
}

void AddInventory(float invChart[7][4], string invName[7], int section) {
    string name;
    double weight;
    double price;
    double amount;
    
    cout << "Enter the section of inventory (1 to 7): ";
    cin >> section;
    
    if((invName[section - 1] == "XXXXXXXXXX") && (invChart[section - 1][1] == 'X') && (invChart[section - 1][2] == 'X') && (invChart[section - 1][3] == 'X')) {

        cout << "Enter item name (Use underscore _ as space): ";
        cin >> name;
        cout << "Enter item weight (pounds) in decimal form: ";
        cin >> weight;
        while (weight < 0) {
            cout << "Please enter a valid weight: ";
            cin >> weight;
        }
        cout << "Enter item price (dollars.cents): ";
        cin >> price;
        while (price < 0) {
            cout << "Please enter a valid price: ";
            cin >> price;
        }
        cout << "Enter item amount in decimal form: ";
        cin >> amount;
        while (amount < 0) {
            cout << "Please enter a valid amount: ";
            cin >> amount;
        }
        
        invName[section - 1] = name;
        invChart[section - 1][0] = ' ';
        invChart[section - 1][1] = weight;
        invChart[section - 1][2] = price;
        invChart[section - 1][3] = amount;
        cout << "Your item of name: " << name << ", weight: " << weight << ", price: " << price << ", amount: " << amount << " has been added.\n";
    }
    else {
        cout << "Enter item name (Use underscore _ as space): ";
        cin >> name;
        cout << "Enter item weight: ";
        cin >> weight;
        cout << "Enter item price: ";
        cin >> price;
        cout << "Enter item amount: ";
        cin >> amount;
        
        if ((name == invName[section - 1]) && (weight == invChart[section - 1][1]) && (price == invChart[section - 1][2])) {
            invName[section - 1] = name;
            invChart[section - 1][0] = ' ';
            invChart[section - 1][1] = weight;
            invChart[section - 1][2] = price;
            invChart[section - 1][3] = invChart[section - 1][3] + amount;
            cout << "Your item of name: " << name << ", weight: " << weight << ", price: " << price << ", amount: " << amount << " has been added to your current amount.\n";
        }
        else {
            cout << "Sorry, this section is already taken.";
        }
    }
}

void CheckInventory(float invChart[7][4], string invName[7]) {
    cout << "STATUS OF INVENTORY:";
    for(int i = 0; i < 7; i++) {
        cout << "\nSection " << i + 1 << ": ";
        for(int j = 0; j < 4; j++) {
            if (invChart[i][j] != 'X' && invName[i] != "XXXXXXXXXX") {
                if (j == 0) {
                    cout << "name: " << invName[i] << " |";    
                }
                else if (j == 1) {
                    cout << " weight: " << invChart[i][j] << " |";
                }
                else if (j == 2) {
                    cout << " price: " << invChart[i][j] << " |";
                }
                else {
                    cout << " amount: " << invChart[i][j];
                }
            }
            else {
                cout << "  ";
            }
        }
    }
}

void AddUpTotal(float invChart[7][4], string invName[7]) {
    double weightTotal = 0.0;
    double priceTotal = 0.0;
    double amountTotal = 0.0;
    for (int i = 0; i < 7; i++) {
        for (int j = 0; j < 4; j++) {
            if (invChart[i][j] == 'X') {
                invChart[i][j] = 0.0;
            }
        }
    }
    for (int i = 0; i < 7; i++) {
        weightTotal = weightTotal + (invChart[i][1] * invChart[i][3]);
    }
    for (int i = 0; i < 7; i++) {
        priceTotal = priceTotal + (invChart[i][2] * invChart[i][3]);
    }
    for (int i = 0; i < 7; i++) {
        amountTotal = amountTotal + invChart[i][3];
    }
    if (amountTotal == 1) {
        cout << "Your inventory consists of " << amountTotal << " item, in total weighing " << weightTotal << " pounds and costing $" << priceTotal;
    }
    else {
        cout << "Your inventory consists of " << amountTotal << " items, in total weighing " << weightTotal << " pounds and costing $" << priceTotal;
    }
    for (int i = 0; i < 7; i++) {
        for (int j = 0; j < 4; j++) {
            if (invName[i] == "XXXXXXXXXX") {
                invChart[i][j] = 'X';
            }
        }
    }
}
